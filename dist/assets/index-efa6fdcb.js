(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))t(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function a(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(o){if(o.ep)return;o.ep=!0;const r=a(o);fetch(o.href,r)}})();const u="f3ab9fbdd61342c0b05ff2e4d1d7a5e9",h=new URLSearchParams(window.location.search),m=h.get("code");async function f(e){const n=g(128),a=await y(n);localStorage.setItem("verifier",n);const t=new URLSearchParams;t.append("client_id",e),t.append("response_type","code"),t.append("redirect_uri","http://localhost:5173/callback"),t.append("scope","user-read-private user-read-email user-read-recently-played user-top-read"),t.append("code_challenge_method","S256"),t.append("code_challenge",a),document.location=`https://accounts.spotify.com/authorize?${t.toString()}`}function g(e){let n="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let t=0;t<e;t++)n+=a.charAt(Math.floor(Math.random()*a.length));return n}async function y(e){const n=new TextEncoder().encode(e),a=await window.crypto.subtle.digest("SHA-256",n);return btoa(String.fromCharCode.apply(null,[...new Uint8Array(a)])).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function T(e,n){const a=localStorage.getItem("verifier"),t=new URLSearchParams;t.append("client_id",e),t.append("grant_type","authorization_code"),t.append("code",n),t.append("redirect_uri","http://localhost:5173/callback"),t.append("code_verifier",a);const o=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:t}),{access_token:r}=await o.json();return r}async function w(e){return await(await fetch("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:`Bearer ${e}`}})).json()}async function b(e){const t=(await(await fetch("https://api.spotify.com/v1/me/player/recently-played?limit=30",{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}})).json()).items.map(l=>({title:l.track.name,artist:l.track.artists[0].name,album:l.track.album.name}));console.log("Here are the Recent Tracks:"),console.log(t);const i=(await(await fetch("https://api.spotify.com/v1/me/top/tracks?time_range=short_term&limit=30",{method:"GET",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}})).json()).items.map(l=>({title:l.name,artist:l.artists[0].name,album:l.album.name}));return console.log("Here are the Top Tracks:"),console.log(i),{topTracks:i,recentTracks:t}}function E(e,n){const a=document.createElement("table"),t=["Top 30 Title","Top 30 Artist","Top 30 Album"],o=document.createElement("tr");t.forEach(c=>{const s=document.createElement("th");s.textContent=c,o.appendChild(s)}),a.appendChild(o),e.forEach(c=>{const s=document.createElement("tr");s.innerHTML=`
      <td>${c.title}</td>
      <td>${c.artist}</td>
      <td>${c.album}</td>
    `,a.appendChild(s)});const r=document.getElementById("topTable");r.innerHTML="",r.appendChild(a);const i=document.createElement("table"),l=["Recent Title","Recent Artist","Recent Album"],d=document.createElement("tr");l.forEach(c=>{const s=document.createElement("th");s.textContent=c,d.appendChild(s)}),i.appendChild(d),n.forEach(c=>{const s=document.createElement("tr");s.innerHTML=`
      <td>${c.title}</td>
      <td>${c.artist}</td>
      <td>${c.album}</td>
    `,i.appendChild(s)});const p=document.getElementById("recentTable");p.innerHTML="",p.appendChild(i)}function C(e){if(document.getElementById("displayName").innerText=e.display_name,e.images[0]){const n=new Image(200,200);n.src=e.images[0].url,document.getElementById("avatar").appendChild(n)}document.getElementById("id").innerText=e.id,document.getElementById("email").innerText=e.email,document.getElementById("uri").innerText=e.uri,document.getElementById("uri").setAttribute("href",e.external_urls.spotify),document.getElementById("url").innerText=e.href,document.getElementById("url").setAttribute("href",e.href),document.getElementById("imgUrl").innerText=e.images[0]?.url??"(no profile image)"}if(!m)f(u);else{const e=await T(u,m);console.log(e);const n=await w(e);C(n);const a=await b(e);console.log(a.topTracks),console.log(a.recentTracks),E(a.topTracks,a.recentTracks)}
